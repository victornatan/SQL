USE FABRICAR;

CREATE TABLE CLIENTE(
IDCLIENTE INT PRIMARY KEY IDENTITY,
DATA DATE,
NOME VARCHAR(60),
DATA_DE_NASCIMENTO DATE,
CPF VARCHAR(20) UNIQUE,
CNPJ VARCHAR (25) UNIQUE,
EMAIL VARCHAR(70),
RUA VARCHAR(50),
NUMERO INT,
BAIRRO VARCHAR(30),
CIDADE VARCHAR(30),
ESTADO CHAR(2),
DDD CHAR(2),
TELEFONE VARCHAR(15)
)


CREATE TABLE CARGO(
IDCARGO INT PRIMARY KEY IDENTITY,
NOME VARCHAR(60) NOT NULL,
)


CREATE TABLE FUNCIONARIO (
IDFUNCIONARIO INT PRIMARY KEY IDENTITY,
DATA_DE_ADMISSAO DATE,
NOME VARCHAR(50),
CPF VARCHAR(20) NOT NULL,
PIS VARCHAR(20) NOT NULL,
RUA VARCHAR(30),
NUMERO INT,
BAIRRO VARCHAR(30),
CIDADE VARCHAR(30),
ESTADO CHAR(2),
DDD CHAR(2),
TELEFONE VARCHAR(15),
SEXO CHAR(2),
ID_CARGO INT,
STATUS VARCHAR(30) CHECK(STATUS IN (  'ATIVO','DESLIGADO')),
SALARIO_BRUTO MONEY,
SALARIO_BRUTO_COM_COMISSAO MONEY
)

ALTER TABLE FUNCIONARIO ADD CONSTRAINT FK_FUNCIONARIO_CARGO FOREIGN KEY (ID_CARGO) REFERENCES CARGO (IDCARGO);


CREATE TABLE ESTADO(
IDESTADO INT PRIMARY KEY IDENTITY,
UF CHAR(2)
)

CREATE TABLE AREA_DE_ATUAÇAO_VENDEDOR(
IDVENDEDOR INT PRIMARY KEY IDENTITY,
ID_FUNCIONARIO INT,
ID_ESTADO INT
)

ALTER TABLE AREA_DE_ATUAÇAO_VENDEDOR ADD CONSTRAINT FK_ATUAÇAO_FUNCIONARIO FOREIGN KEY (ID_FUNCIONARIO) REFERENCES FUNCIONARIO (IDFUNCIONARIO);
ALTER TABLE AREA_DE_ATUAÇAO_VENDEDOR ADD CONSTRAINT FK_ATUAÇAO_ESTADO FOREIGN KEY (ID_ESTADO) REFERENCES ESTADO (IDESTADO);

CREATE TABLE FORNECEDOR (
IDFORNECEDOR INT PRIMARY KEY IDENTITY,
DATA_DE_ENTRADA DATE,
NOME VARCHAR(100),
TIPO_DE_MATERIAL VARCHAR(100),
CNPJ VARCHAR(20),
DDD CHAR(2),
TELEFONE VARCHAR(15),
EMAIL VARCHAR(70),
NUMERO INT,
RUA VARCHAR(40),
BAIRRO VARCHAR(30),
CIDADE VARCHAR(30),
ESTADO CHAR(2),
SITUAÇAO VARCHAR(30) CHECK (SITUAÇAO IN ('COMPLETA', 'BLOQUEADO', 'PENDENTE'))

)

CREATE TABLE PRODUTO (
IDPRODUTO INT PRIMARY KEY IDENTITY,
NOME VARCHAR(50),
TIPO VARCHAR(100),
COR VARCHAR(15),
TURBO CHAR(3) CHECK  (TURBO IN ('SIM', 'NAO')),
PORTAS INT,
PREÇO MONEY
)

CREATE TABLE ESTOQUE_DE_MATERIAL (
IDESTOQUE INT PRIMARY KEY IDENTITY,
DATA_DE_ENTRADA DATE,
ID_FORNECEDOR INT,
LOTE VARCHAR(15) UNIQUE,
NOME VARCHAR(60),
TIPO VARCHAR(30),
COR VARCHAR(20),
TAMANHO VARCHAR(30),
QUANTIDADE INT,
DATA_DE_VALIDADE DATE
)

ALTER TABLE ESTOQUE_DE_MATERIAL ADD CONSTRAINT FK_ESTOQUE_FORNECEDOR FOREIGN KEY (ID_FORNECEDOR) REFERENCES FORNECEDOR (IDFORNECEDOR);


CREATE TABLE PEDIDO(
IDPEDIDO INT PRIMARY KEY IDENTITY,
DATA_DE_EMISSAO DATETIME,
ID_CLIENTE INT,
ID_PRODUTO INT,
ID_VENDEDOR INT,
QUANTIDADE INT,
DATA_DE_ENTREGA DATE,
MODO_DE_PAGAMENTO VARCHAR(20) CHECK(MODO_DE_PAGAMENTO IN  ('DINHEIRO', 'PIX', 'CARTAO DE CREDITO','CARTAO DE DEBITO', 'CHEQUE','BOLETO')),
PARCELAS INT DEFAULT '0',
PREÇO_TOTAL DECIMAL(10,2) 
)


ALTER TABLE PEDIDO ADD CONSTRAINT FK_PEDIDO_CLIENTE FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE (IDCLIENTE);
ALTER TABLE PEDIDO ADD CONSTRAINT FK_PEDIDO_PRODUTO FOREIGN KEY (ID_PRODUTO) REFERENCES PRODUTO (IDPRODUTO);
ALTER TABLE PEDIDO ADD CONSTRAINT FK_PEDIDO_VENDEDOR FOREIGN KEY (ID_VENDEDOR) REFERENCES AREA_DE_ATUAÇAO_VENDEDOR (IDVENDEDOR);



CREATE TABLE META_VENDEDOR (
IDMETA INT PRIMARY KEY IDENTITY,
ID_VENDEDOR INT,
VALOR_META MONEY,
ANDAMENTO DECIMAL (10,2)

)

ALTER TABLE META_VENDEDOR ADD CONSTRAINT FK_META_VENDEDOR_AREA_DE_ATUAÇAO_VENDEDOR FOREIGN KEY (ID_VENDEDOR) REFERENCES AREA_DE_ATUAÇAO_VENDEDOR (IDVENDEDOR);


CREATE TABLE MATERIAL_PRA_CONSUMO (
IDMATERIAL INT PRIMARY KEY IDENTITY,
DATA_DE_SAIDA DATE,
ID_PEDIDO INT,
ID_ESTOQUE INT,
QUANTIDADE INT
)


ALTER TABLE MATERIAL_PRA_CONSUMO ADD CONSTRAINT FK_MATERIAL_ESTOQUE FOREIGN KEY (ID_ESTOQUE) REFERENCES ESTOQUE_DE_MATERIAL (IDESTOQUE);
ALTER TABLE MATERIAL_PRA_CONSUMO ADD CONSTRAINT FK_METERIAL_PEDIDO FOREIGN KEY (ID_PEDIDO) REFERENCES PEDIDO (IDPEDIDO);



CREATE TABLE PRODUTO_EM_FABRICAÇAO (
IDFABRICAÇAO INT PRIMARY KEY IDENTITY,
DATA DATE,
NOME VARCHAR(60), 
CPF VARCHAR(20),   
CNPJ VARCHAR (25) ,
ID_PEDIDO INT,     
ID_VENDEDOR INT, 
QUANTIDADE INT,   
DATA_DE_ENTREGA DATE,
NOMEP VARCHAR(50),     
TIPO VARCHAR(200),      
COR VARCHAR(15),        
TURBO CHAR(3) CHECK  (TURBO IN ('SIM', 'NAO')), 
PORTAS INT,                                  
STATUS VARCHAR(50) DEFAULT 'ABERTO'  
)


CREATE TABLE NF_CLIENTE (
IDNF INT PRIMARY KEY IDENTITY,
DATA_DE_EMISSAO DATE, 
NOME VARCHAR(60),  
CPF VARCHAR(20), 
QUANTIDADE INT,   
CNPJ_FABRICANTE VARCHAR(30),  
CNPJ VARCHAR (25),  
PREÇO_TOTAL MONEY,  
PROTOCOLO_DE_AUTENTICAÇAO VARCHAR(100) UNIQUE , 
ID_FABRICAÇAO INT,
ID_PEDIDO INT,
NOMEP VARCHAR(50),
TIPO VARCHAR(200),
COR VARCHAR(15),
TURBO CHAR(3),
PORTAS INT
)


CREATE TABLE HISTORICO_META(
IDHISTORICO INT PRIMARY KEY IDENTITY,
ID_VENDEDOR INT,
VALOR_META MONEY,
ANDAMENTO MONEY,
DATA_FINAL_META DATE
)


CREATE TABLE FOLHA_DE_PAGAMENTO(
IDFOLHA INT PRIMARY KEY IDENTITY,
DATA_DO_PAGAMENTO DATE,
MES_DE_REFERENCIA INT,
ID_FUNCIONARIO INT,
SALARIO_BRUTO MONEY,
INSS DECIMAL(10,2),
SALARIO_LIQUIDO MONEY
)

ALTER TABLE [dbo].[folha_de_pagamento]  WITH CHECK ADD  CONSTRAINT [fk_funcionario_folha] FOREIGN KEY([id_funcionario])
REFERENCES [dbo].[FUNCIONARIO] ([IDFUNCIONARIO])




CREATE TABLE USUARIOS(
IDUSUARIO INT PRIMARY KEY IDENTITY,
LOGIN VARCHAR(60) NOT NULL,
SENHA VARCHAR(60) NOT NULL
